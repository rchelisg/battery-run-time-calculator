<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Page description -->
  <meta name="description" content="Calculate how long your battery will last based on capacity and load.">
  <meta name="theme-color" content="#1976D2">

  <!-- Apple PWA meta tags (required for iPhone) -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Battery Calc">
  <link rel="apple-touch-icon" href="icons/icon.png">

  <!-- PWA manifest -->
  <link rel="manifest" href="manifest.json">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="icons/icon.png">

  <title>Battery Run Time Calculator</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>

  <div class="app-container">

    <header class="app-header">
      <h1>ðŸ”‹ Battery Run Time Calculator</h1>
    </header>

    <!-- â”€â”€ Navigation tabs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <nav class="nav-bar" aria-label="App sections">
      <button class="nav-btn active" id="nav-calc">Calc</button>
      <button class="nav-btn"        id="nav-time">D<span class="nav-df">f</span>Time</button>
      <button class="nav-btn"        id="nav-cost">D<span class="nav-df">f</span>Cost</button>
      <button class="nav-btn"        id="nav-load">D<span class="nav-df">f</span>Load</button>
    </nav>

    <main class="app-main">

      <!-- â•â• PAGE Calc â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <!-- PACK + LOAD/L(x) + REPORT TIME (T calculated from E and L)        -->
      <div id="page-calc" class="page">

        <!-- â”€â”€ PACK card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="card pack-card">
          <h2>PACK</h2>

          <!-- Content area: input row + error strip -->
          <div class="pack-content">

            <div class="pack-row">

              <!-- N: cells in series â€” single digit only -->
              <div class="pack-field pack-field-narrow">
                <label class="pack-label" for="input-N">Cells</label>
                <input class="field-input pack-input" type="text" id="input-N"
                       inputmode="numeric" maxlength="1" value="7">
              </div>

              <!-- C: nominal cell capacity â€” extra right margin separates it from Min/Max group -->
              <div class="pack-field pack-field-nominal">
                <label class="pack-label" for="input-C">Nominal</label>
                <div class="pack-input-row">
                  <input class="field-input pack-input pack-input-c" type="text" id="input-C"
                         inputmode="numeric" min="100" max="8000" step="1" value="2000">
                  <span class="pack-unit">mAh</span>
                </div>
              </div>

              <!-- Cmin + Cmax: grouped and right-aligned via margin-left:auto -->
              <div class="pack-minmax-group">

                <div class="pack-field">
                  <label class="pack-label" for="input-Cmin">Min</label>
                  <div class="pack-input-row">
                    <input class="field-input pack-input pack-input-c" type="text" id="input-Cmin"
                           inputmode="numeric" step="1">
                    <span class="pack-unit">mAh</span>
                  </div>
                </div>

                <div class="pack-field">
                  <label class="pack-label" for="input-Cmax">Max</label>
                  <div class="pack-input-row">
                    <input class="field-input pack-input pack-input-c" type="text" id="input-Cmax"
                           inputmode="numeric" step="1">
                    <span class="pack-unit unit-max">mAh</span>
                  </div>
                </div>

              </div><!-- /pack-minmax-group -->

            </div><!-- /pack-row -->

            <!-- Shared error strip â€” fixed height so card never resizes -->
            <p class="pack-error" id="pack-error"></p>

          </div><!-- /pack-content -->

          <!-- Invisible spacer â€” matches LOAD +/- strip width; aligns Cmax/Lmax right edges -->
          <div class="pack-ctrl-spacer" aria-hidden="true"></div>

        </div><!-- /pack-card -->

        <!-- â”€â”€ LOAD group: summary + individual LOAD x cards (tight spacing) â”€â”€ -->
        <div class="load-group" id="load-group">

          <!-- LOAD summary card â€” display-only totals; always shown at top of group -->
          <div class="card load-card load-summary-card" id="load-summary-card">
            <h2>LOAD</h2>
            <div class="load-content">
              <div class="load-row">
                <!-- Nominal total -->
                <div class="load-field load-field-nominal">
                  <label class="load-label">Nominal</label>
                  <div class="load-input-row">
                    <span class="load-summary-val" id="ls-L">â€”</span>
                    <span class="load-unit">W</span>
                  </div>
                </div>
                <!-- Min + Max totals grouped right -->
                <div class="load-minmax-group">
                  <div class="load-field">
                    <label class="load-label">Min</label>
                    <div class="load-input-row">
                      <span class="load-summary-val" id="ls-Lmin">â€”</span>
                      <span class="load-unit">W</span>
                    </div>
                  </div>
                  <div class="load-field">
                    <label class="load-label">Max</label>
                    <div class="load-input-row">
                      <span class="load-summary-val" id="ls-Lmax">â€”</span>
                      <span class="load-unit">W</span>
                    </div>
                  </div>
                </div><!-- /load-minmax-group -->
              </div><!-- /load-row -->
            </div><!-- /load-content -->
            <!-- Spacer matches LOAD cards' +/- strip width for consistent alignment -->
            <div class="pack-ctrl-spacer" aria-hidden="true"></div>
          </div><!-- /load-summary-card -->

          <!-- LOAD x cards container â€” dynamically added / removed -->
          <div id="load-cards-container"></div>

        </div><!-- /load-group -->

        <!-- â”€â”€ REPORT TIME card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <!-- Extra top margin gives 2Ã— spacing after the last LOAD card   -->
        <!-- T / Tmin / Tmax are calculated from PACK and LOAD (E = NÃ—3.6Ã—C/1000) -->
        <div class="card report-time-card" id="report-time-card">
          <button id="rpt-copy-btn" class="rpt-copy-btn" aria-label="Copy report to clipboard" title="Copy to clipboard">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                 fill="none" stroke="currentColor" stroke-width="2"
                 stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <rect x="9" y="2" width="6" height="4" rx="1"/>
              <path d="M8 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-2"/>
            </svg>
          </button>
          <div id="report-time-wrap" aria-live="polite" aria-label="Run time report"></div>
        </div><!-- /report-time-card -->

      </div><!-- /page-calc -->

      <!-- â•â• PAGE Time â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <!-- TIME card shown first; PACK + LOAD revealed after first valid T   -->
      <div id="page-time" class="page page-hidden">

        <!-- â”€â”€ TIME card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="card load-card time-card" id="time-card">
          <h2>TIME</h2>
          <div class="load-content">
            <div class="load-row">

              <!-- T: nominal run time (user entry) -->
              <div class="load-field load-field-nominal">
                <label class="load-label" for="input-T">Nominal</label>
                <div class="load-input-row">
                  <input class="field-input load-input" type="text"
                         id="input-T" inputmode="decimal" step="0.1">
                  <span class="load-unit">Min</span>
                </div>
              </div>

              <!-- Tmin + Tmax grouped right -->
              <div class="load-minmax-group">
                <div class="load-field">
                  <label class="load-label" for="input-Tmin">Min</label>
                  <div class="load-input-row">
                    <input class="field-input load-input" type="text"
                           id="input-Tmin" inputmode="decimal" step="0.1">
                    <span class="load-unit">Min</span>
                  </div>
                </div>
                <div class="load-field">
                  <label class="load-label">Max</label>
                  <div class="load-input-row">
                    <input class="field-input load-input time-calc-field"
                           type="text" id="input-Tmax" readonly placeholder="â€”">
                    <span class="load-unit unit-max">Min</span>
                  </div>
                </div>
              </div><!-- /load-minmax-group -->

            </div><!-- /load-row -->
            <p class="load-error" id="time-error"></p>
          </div><!-- /load-content -->

          <!-- Controls strip: buttons hidden â€” TIME card is always exactly one -->
          <div class="load-controls">
            <button class="load-btn" style="visibility:hidden" disabled aria-hidden="true">âˆ’</button>
            <button class="load-btn" style="visibility:hidden" disabled aria-hidden="true">+</button>
          </div>
        </div><!-- /time-card -->

        <!-- â”€â”€ DT PACK card â€” revealed after first valid T entry â”€â”€ -->
        <div class="card pack-card" id="dt-pack-card" style="display:none">
          <h2>PACK</h2>
          <div class="pack-content">
            <div class="pack-row">
              <div class="pack-field pack-field-narrow">
                <label class="pack-label" for="dt-input-N">Cells</label>
                <input class="field-input pack-input" type="text" id="dt-input-N"
                       inputmode="numeric" maxlength="1">
              </div>
              <div class="pack-field pack-field-nominal">
                <label class="pack-label" for="dt-input-C">Nominal</label>
                <div class="pack-input-row">
                  <input class="field-input pack-input pack-input-c" type="text" id="dt-input-C"
                         inputmode="numeric" min="100" max="8000" step="1">
                  <span class="pack-unit">mAh</span>
                </div>
              </div>
              <div class="pack-minmax-group">
                <div class="pack-field">
                  <label class="pack-label" for="dt-input-Cmin">Min</label>
                  <div class="pack-input-row">
                    <input class="field-input pack-input pack-input-c" type="text" id="dt-input-Cmin"
                           inputmode="numeric" step="1">
                    <span class="pack-unit">mAh</span>
                  </div>
                </div>
                <div class="pack-field">
                  <label class="pack-label" for="dt-input-Cmax">Max</label>
                  <div class="pack-input-row">
                    <input class="field-input pack-input pack-input-c" type="text" id="dt-input-Cmax"
                           inputmode="numeric" step="1">
                    <span class="pack-unit unit-max">mAh</span>
                  </div>
                </div>
              </div>
            </div>
            <p class="pack-error" id="dt-pack-error"></p>
          </div>
          <div class="pack-ctrl-spacer" aria-hidden="true"></div>
        </div><!-- /dt-pack-card -->

        <!-- â”€â”€ DT LOAD group â€” revealed after first valid T entry â”€â”€ -->
        <div class="load-group" id="dt-load-group" style="display:none">
          <div class="card load-card" id="dt-load-summary-card">
            <h2>LOAD</h2>
            <div class="load-content">
              <div class="load-row">
                <div class="load-field load-field-nominal">
                  <label class="load-label">Nominal</label>
                  <div class="load-input-row">
                    <span class="load-summary-val" id="dt-ls-L">â€”</span>
                    <span class="load-unit">W</span>
                  </div>
                </div>
                <div class="load-minmax-group">
                  <div class="load-field">
                    <label class="load-label">Min</label>
                    <div class="load-input-row">
                      <span class="load-summary-val" id="dt-ls-Lmin">â€”</span>
                      <span class="load-unit">W</span>
                    </div>
                  </div>
                  <div class="load-field">
                    <label class="load-label">Max</label>
                    <div class="load-input-row">
                      <span class="load-summary-val" id="dt-ls-Lmax">â€”</span>
                      <span class="load-unit unit-max">W</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="pack-ctrl-spacer" aria-hidden="true"></div>
          </div><!-- /dt-load-summary-card -->
          <div id="dt-load-cards-container"></div>
        </div><!-- /dt-load-group -->

        <!-- â”€â”€ DT output card â€” shown after mode is locked â”€â”€ -->
        <div class="card dt-output-card" id="dt-output-card" style="display:none"></div>

      </div><!-- /page-time -->

      <!-- â•â• PAGE Cost â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <!-- PACK + TIME + LOAD/L(x) shown initially; mode locked on first entry  -->
      <!-- Mode A (TIME first â†’ E,Tâ†’L): compute system load                     -->
      <!-- Mode B (LOAD first â†’ E,Lâ†’T): compute run time                        -->
      <div id="page-cost" class="page page-hidden">

        <!-- â”€â”€ DC PACK card â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <div class="card pack-card" id="dc-pack-card">
          <h2>PACK</h2>
          <div class="pack-content">
            <div class="pack-row">
              <div class="pack-field pack-field-narrow">
                <label class="pack-label" for="dc-input-N">Cells</label>
                <input class="field-input pack-input" type="text" id="dc-input-N"
                       inputmode="numeric" maxlength="1" value="7">
              </div>
              <div class="pack-field pack-field-nominal">
                <label class="pack-label" for="dc-input-C">Nominal</label>
                <div class="pack-input-row">
                  <input class="field-input pack-input pack-input-c" type="text" id="dc-input-C"
                         inputmode="numeric" min="100" max="8000" step="1" value="2000">
                  <span class="pack-unit">mAh</span>
                </div>
              </div>
              <div class="pack-minmax-group">
                <div class="pack-field">
                  <label class="pack-label" for="dc-input-Cmin">Min</label>
                  <div class="pack-input-row">
                    <input class="field-input pack-input pack-input-c" type="text" id="dc-input-Cmin"
                           inputmode="numeric" step="1">
                    <span class="pack-unit">mAh</span>
                  </div>
                </div>
                <div class="pack-field">
                  <label class="pack-label" for="dc-input-Cmax">Max</label>
                  <div class="pack-input-row">
                    <input class="field-input pack-input pack-input-c" type="text" id="dc-input-Cmax"
                           inputmode="numeric" step="1">
                    <span class="pack-unit unit-max">mAh</span>
                  </div>
                </div>
              </div>
            </div>
            <p class="pack-error" id="dc-pack-error"></p>
          </div>
          <div class="pack-ctrl-spacer" aria-hidden="true"></div>
        </div><!-- /dc-pack-card -->

        <!-- â”€â”€ DC TIME card â€” all fields editable; first entry triggers Mode A â”€â”€ -->
        <div class="card load-card time-card" id="dc-time-card">
          <h2>TIME</h2>
          <div class="load-content">
            <div class="load-row">
              <div class="load-field load-field-nominal">
                <label class="load-label" for="dc-input-T">Nominal</label>
                <div class="load-input-row">
                  <input class="field-input load-input" type="text"
                         id="dc-input-T" inputmode="decimal" step="0.1">
                  <span class="load-unit">Min</span>
                </div>
              </div>
              <div class="load-minmax-group">
                <div class="load-field">
                  <label class="load-label" for="dc-input-Tmin">Min</label>
                  <div class="load-input-row">
                    <input class="field-input load-input" type="text"
                           id="dc-input-Tmin" inputmode="decimal" step="0.1">
                    <span class="load-unit">Min</span>
                  </div>
                </div>
                <div class="load-field">
                  <label class="load-label" for="dc-input-Tmax">Max</label>
                  <div class="load-input-row">
                    <input class="field-input load-input" type="text"
                           id="dc-input-Tmax" inputmode="decimal" step="0.1">
                    <span class="load-unit unit-max">Min</span>
                  </div>
                </div>
              </div>
            </div>
            <p class="load-error" id="dc-time-error"></p>
          </div>
          <div class="load-controls" aria-hidden="true">
            <button class="load-btn" style="visibility:hidden" tabindex="-1">âˆ’</button>
            <button class="load-btn" style="visibility:hidden" tabindex="-1">+</button>
          </div>
        </div><!-- /dc-time-card -->

        <!-- â”€â”€ DC LOAD group: summary + L(x) cards; first entry triggers Mode B â”€â”€ -->
        <div class="load-group" id="dc-load-group">
          <div class="card load-card" id="dc-load-summary-card">
            <h2>LOAD</h2>
            <div class="load-content">
              <div class="load-row">
                <div class="load-field load-field-nominal">
                  <label class="load-label">Nominal</label>
                  <div class="load-input-row">
                    <span class="load-summary-val" id="dc-ls-L">â€”</span>
                    <span class="load-unit">W</span>
                  </div>
                </div>
                <div class="load-minmax-group">
                  <div class="load-field">
                    <label class="load-label">Min</label>
                    <div class="load-input-row">
                      <span class="load-summary-val" id="dc-ls-Lmin">â€”</span>
                      <span class="load-unit">W</span>
                    </div>
                  </div>
                  <div class="load-field">
                    <label class="load-label">Max</label>
                    <div class="load-input-row">
                      <span class="load-summary-val" id="dc-ls-Lmax">â€”</span>
                      <span class="load-unit unit-max">W</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="pack-ctrl-spacer" aria-hidden="true"></div>
          </div><!-- /dc-load-summary-card -->
          <div id="dc-load-cards-container"></div>
        </div><!-- /dc-load-group -->

        <!-- â”€â”€ DC REPORT LOAD card (Mode A: TIME first â†’ compute Load) â”€â”€ -->
        <div class="card dc-report-load-card" id="dc-report-load-card" style="display:none">
          <button id="dc-rpt-load-copy-btn" class="rpt-copy-btn" aria-label="Copy report to clipboard" title="Copy to clipboard">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                 fill="none" stroke="currentColor" stroke-width="2"
                 stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <rect x="9" y="2" width="6" height="4" rx="1"/>
              <path d="M8 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-2"/>
            </svg>
          </button>
          <div id="dc-report-load-wrap" aria-live="polite" aria-label="System load report"></div>
        </div><!-- /dc-report-load-card -->

        <!-- â”€â”€ DC REPORT TIME card (Mode B: LOAD first â†’ compute Run Time) â”€â”€ -->
        <div class="card report-time-card" id="dc-report-time-card" style="display:none">
          <button id="dc-rpt-time-copy-btn" class="rpt-copy-btn" aria-label="Copy report to clipboard" title="Copy to clipboard">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                 fill="none" stroke="currentColor" stroke-width="2"
                 stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
              <rect x="9" y="2" width="6" height="4" rx="1"/>
              <path d="M8 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-2"/>
            </svg>
          </button>
          <div id="dc-report-time-wrap" aria-live="polite" aria-label="Run time report"></div>
        </div><!-- /dc-report-time-card -->

      </div><!-- /page-cost -->

      <!-- â•â• PAGE Load â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <div id="page-load" class="page page-hidden">
        <!-- content coming soon -->
      </div><!-- /page-load -->

    </main>

    <footer class="app-footer">
      <p><span id="footer-timestamp"></span>BRTC &copy; 2026 V2.7</p>
    </footer>

  </div>

  <script src="js/app.js"></script>
</body>
</html>
